<div class="app-container">
    <div class="annotation-container">
        <div class="upload-container">
            <mat-form-field class="upload-file-form-field">
                <h3>Upload pdf</h3>
                <div>
                    <mat-toolbar>
                        <input matInput [(ngModel)]="fileAttr" readonly name="name" />
                        <button mat-flat-button color="primary">Browse File</button>
                    </mat-toolbar>
                    <input type="file" #fileInput id="uploadFile" (change)="uploadFileEvt($event)" name="uploadFile"
                        accept="application/pdf" />
                </div>
            </mat-form-field>
            <mat-form-field class="upload-file-form-field">
                <h3>Upload Json</h3>
                <div>
                    <mat-toolbar>
                        <input matInput [(ngModel)]="jsonFileAttr" readonly name="name" />
                        <button mat-flat-button color="primary">Browse File</button>
                    </mat-toolbar>
                    <input type="file" #jsonFileInput id="jsonUploadFile" (change)="uploadJsonFileEvt($event)"
                        name="uploadJsonFile" accept="application/json" />
                </div>
            </mat-form-field>
        </div>
        <div class="ner-cotainer" style="position: relative;">
            <mat-divider style="margin: 2px;"></mat-divider>
            <div style="text-align: center; position: relative;">
                <h4>Select NER Labels</h4>
            </div>
            <div style="display: flex; flex-wrap: wrap; justify-content: center;">
                <div style="margin-bottom: 20px; margin-right: 10px; " *ngFor="let label of labels">
                    <button mat-raised-button [style.z-index]="label.zIndex"
                        (click)="onAnnotationSelect(label)">{{label.label}}</button>
                </div>
            </div>
            <mat-divider style="margin: 2px;"></mat-divider>
        </div>

        <div class="data-points-container">
            <div>
                <button style="margin: 1px;" *ngIf="!bboxShown" [disabled]="!bboxReady&&!bboxShown" mat-raised-button
                    (click)="showBboxes()">Show
                    Bbox</button>
                <button style="margin: 1px;" *ngIf="bboxShown" mat-raised-button (click)="hideBboxes()">Hide
                    BBox</button>
                <button style="margin: 1px;" [disabled]="file==null" mat-raised-button color="primary"
                    (click)="downloadImage()">Download Image</button>
                <button style="margin: 1px;" [disabled]="dataSource.data.length==0" mat-raised-button color="primary"
                    (click)="exportAnnotations()">Export Annotations</button>
            </div>
            <div class="mat-elevation-z8">
                <table mat-table [dataSource]="dataSource">
                    <ng-container matColumnDef="id">
                        <th mat-header-cell *matHeaderCellDef> id </th>
                        <td mat-cell *matCellDef="let element"> {{element.id}} </td>
                    </ng-container>


                    <ng-container matColumnDef="label">
                        <th mat-header-cell *matHeaderCellDef> label </th>
                        <td mat-cell *matCellDef="let element"> {{element.label}} </td>
                    </ng-container>


                    <ng-container matColumnDef="text">
                        <th mat-header-cell *matHeaderCellDef> text </th>
                        <td mat-cell *matCellDef="let element"> {{element.text}} </td>
                    </ng-container>


                    <ng-container matColumnDef="box">
                        <th mat-header-cell *matHeaderCellDef> box </th>
                        <td mat-cell *matCellDef="let e"> [{{e.box[0]}}, {{e.box[1]}}, {{e.box[2]}}, {{e.box[3]}}] </td>
                    </ng-container>

                    <ng-container matColumnDef="linking">
                        <th mat-header-cell *matHeaderCellDef> linking </th>
                        <td mat-cell *matCellDef="let element"> {{element.linking}} </td>
                    </ng-container>

                    <ng-container matColumnDef="action">
                        <th mat-header-cell *matHeaderCellDef> Action </th>
                        <td mat-cell *matCellDef="let element">
                            <button mat-icon-button matTooltip="Click to Delete" class="iconbutton"
                                (click)="deleteAnnotation(element.id)">
                                <mat-icon>delete_outline</mat-icon>
                            </button>
                        </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                </table>

                <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons
                    aria-label="Select page of periodic elements">
                </mat-paginator>
            </div>

        </div>
    </div>
    <div #viewContainer class="view-container">
        <div class="pdf-pagination-container">
            <div>
                <button mat-icon-button [disabled]="currentPage==1" (click)="goToPreviousPage()">
                    <mat-icon>keyboard_arrow_left</mat-icon>
                </button>
            </div>
            <div style="padding: 10px;">
                {{currentPage}}/{{totalPages}}
            </div>
            <div>
                <button mat-icon-button [disabled]="currentPage==totalPages" (click)="goToNextPage()">
                    <mat-icon>keyboard_arrow_right</mat-icon>
                </button>
            </div>
        </div>
        <div id="pdfContainer1" class="pdf-container1" [style.z-index]="pdfContainer1ZIndex">
            <div #pdfContainer2 id="pdfContainer2" class="pdf-container2" (mousedown)="onMouseDown($event)"
                (mousemove)="onMouseMove($event)" (mouseup)="onMouseUp($event)">
                <ng-template #bboxTemplate class="pdf-template"></ng-template>
                <ng-template #template class="pdf-template"></ng-template>
                <pdf-viewer id="pdfViewer" class="pdf-viewer" [src]="fileData" [(page)]="currentPage"
                    [rotation]="rotation" [original-size]="originalSize" [show-all]="showAll" [fit-to-page]="fitToPage"
                    (after-load-complete)="afterLoadComplete($event)" [zoom]="zoom" [zoom-scale]="zoomScale"
                    [stick-to-page]="stickToPage" [render-text]="renderText" [external-link-target]="'blank'"
                    [autoresize]="autoresize" (page-rendered)="pageRendered($event)"
                    (after-load-complete)="afterLoadComplete($event)" [show-borders]="false"></pdf-viewer>
            </div>
        </div>
        <div></div>
    </div>
    

</div>
<div *ngIf="annoStarted" class="overlay-container">
    <div class="overlay-close-div" (click)="onAnnoClose()">
        <mat-icon class="mat-icon-close">close</mat-icon>
    </div>

</div>